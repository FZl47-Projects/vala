{% extends 'base-template.html' %}
{% load static %}


{% block title %}خانه{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'styles/index.css' %}">
{% endblock %}

{% block content %}
    <!-- Start Menu-fixed-right -->
    {% include 'includes/menu/sidebar.html' %}
    <!-- .End Menu-fixed-right -->

    <!-- Start Menu-bottom -->
    {% include 'includes/menu/bottombar.html' %}
    <!-- .End Menu-bottom -->

    <div class="container-fluid container-admin position-relative">
        <!-- Start Menu -->
        {% include 'includes/menu/collapse-menu.html' %}
        <!-- .End Menu -->

        <!-- Start Menu-mobile-->
        {% include 'includes/menu/mobile-menu.html' %}
        <!-- .End Menu-mobile -->

        <!-- Start Modal-routine -->
        {% include 'public/components/skin-routine.html' %}
        <!-- .End Modal-routine -->

        <!-- Start Free test modal -->
        {% include 'public/components/free-test.html' %}
        <!-- .End Free test modal -->

        <!-- Start Fullscreen highlights -->
        <div id="container-modals">
            {% for story in stories %}
                <div class="content-modal modal-hilight-pro">
                    <div class="inner-modal d-flex flex-column ">
                        <div class="btn-exit display-1 text-white">×</div>
                        <div class="border-1 border-white rounded-4 overflow-hidden ">
                            <img class="h-100" src="{{ story.get_image_url }}" alt="{{ story.title }}">
                        </div>
                        <p class="text-white text-justify my-4" style="font-size : 1.5em">{{ story.title }}</p>
                        <div class="text-white">
                            <button class="display-1 mx-2 btn-story next" onclick="nextHandler({{ forloop.counter0 }})">&lt;</button>
                            <button class="display-1 mx-2 btn-story prev" onclick="prevHandler({{ forloop.counter0 }})">&gt;</button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        <!-- .End Fullscreen highlights -->

        <main class="main container-fluid container-admin">

            <!-- Start Highlights -->
            <div class="highlit-category ">
                <div class="inner-highlit-category col-12 col-md-5">
                    <div class="content-highlit" id="container-story">

                        {% for story in stories %}
                            <div class="col-3 col-md-2 p-2 highlit-item story_item">
                                <div class="highlit-item-inner">
                                    <img src="{{ story.get_image_url }}" alt="{{ story.title }}">
                                </div>
                                <div class="highlit-title">{{ story.title }}</div>
                            </div>
                        {% endfor %}

                    </div>
                </div>
            </div>
            <!-- .End Highlights -->

            <!-- Start post category -->
            <div class="posts-category posts-category-two">
                <div class="inner-post-category w-100" id="posts-container">
                    {% for post in posts %}
                        <div class="post-item col-3 col-md-12">
                            <div class="col-12 col-md-4 col-lg-3 p-1">
                                <div class="right-post-item">
                                    <img src="{{ post.get_image_url }}" alt="{{ post.title }}">
                                </div>
                            </div>
                            <div class="col-8 col-md-7 col-lg-8 p-1">
                                <div class="left-post-item">
                                    <div class="title-post">{{ post.title }}</div>
                                    <div class="des-post">
                                        {{ post.caption|truncatechars:85 }}
                                    </div>
                                    <div class="text-white post-category-title">دسته: {{ post.category }}</div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div id="big-container">
                {% for post in posts %}
                    <div class="content-post">
                        <img src="{{ post.get_image_url }}" alt="{{ post.title }}" class="imge-post">
                        <div class="inner-content-post-two">
                            <div class="line">
                                <div class="row">
                                    <div class="col-2 icon">
                                        <div class="heart">
                                            <i class="bi bi-heart{% if post.user_liked %}-fill{% endif %} text-white like-icon"
                                               style="font-size: 1.4rem;" onclick="likePost({{ post.id }}, this)"></i>
                                        </div>
                                        <div class="comment">
                                            <img src="{% static 'images/icons/comment.png' %}" alt="Comment icon">
                                        </div>
                                    </div>
                                    <div class="col-10 pt-3">
                                        <div class="up-content-post">
                                            <div class="title-post">{{ post.title }}</div>
                                            <div class="description">
                                               {{ post.caption }}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <form method="POST" action="{% url 'public:add_post_comment' %}" class="insert-comment col-10 mx-auto">
                                    {% csrf_token %}
                                    <div class="image-insert mx-2">
                                        <img src="{% static 'images/default/user-default.png' %}" alt="User profile pic">
                                    </div>
                                    <label class="comment-insert">
                                        <input type="hidden" name="post" value="{{ post.id }}">
                                        <input type="text" name="text" placeholder="کامنت ..." class="comment-input" required>
                                        <button type="submit" class="btn-send btn">ارسال</button>
                                    </label>
                                </form>

                                <!-- Start post comments -->
                                <div class="commentt">
                                    <div class="w-100 mt-4">
                                        {% for comment in post.get_verified_comments %}
                                            <div class="comment-item mt-2">
                                                <div class="col-2 col-md-1 p-1">
                                                    <div class="imge-comment">
                                                        <img src="{{ comment.user.user_profile.get_image_url }}" width="55" height="52" alt="User profile pic">
                                                    </div>
                                                </div>
                                                <div class="col-10 col-md-11 text-white" style="padding: 0.5rem 4rem; font-weight: 500;">
                                                    {{ comment.text }}
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                                <!-- .End post comments -->

                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </main>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{% static 'js/home.js' %}"></script>
    <script src="{% static 'js/menus.js' %}"></script>
{% endblock %}
